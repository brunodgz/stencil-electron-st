import*as tslib_1 from"../polyfills/tslib.js";import{h}from"../app.core.js";import{a as matchPath,d as matchesAreEqual,c as ActiveRouter,e as storageAvailable,f as canUseDOM,g as supportsHistory,h as supportsPopStateOnHashChange,i as getConfirmation,j as stripTrailingSlash,k as addLeadingSlash,l as hasBasename,m as stripBasename,n as createLocation,o as createKey,p as createPath,q as addEventListener,r as removeEventListener,s as isExtraneousPopstateEvent,t as supportsGoWithoutReloadUsingHash,u as stripLeadingSlash,v as locationsAreEqual}from"./chunk-35bbecbf.js";var AppRoot=function(){function t(){}return t.prototype.render=function(){return h("div",null,h("header",null,h("h1",null,"Stencil App Starter")),h("main",null,h("stencil-router",{historyType:"hash"},h("stencil-route-switch",{scrollTopOffset:0},h("stencil-route",{url:"/",component:"app-home",exact:!0}),h("stencil-route",{url:"/profile/:name",component:"app-profile"})))))},Object.defineProperty(t,"is",{get:function(){return"app-root"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"encapsulation",{get:function(){return"shadow"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"style",{get:function(){return"/**style-placeholder:app-root:**/"},enumerable:!0,configurable:!0}),t}(),__awaiter=function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(a,s)}c((o=o.apply(t,e||[])).next())})},Route=function(){function t(){this.group=null,this.match=null,this.componentProps={},this.exact=!1,this.scrollOnNextRender=!1,this.previousMatch=null}return t.prototype.computeMatch=function(t){var e=null!=this.group||null!=this.el.parentElement&&"stencil-route-switch"===this.el.parentElement.tagName.toLowerCase();if(t&&!e)return this.previousMatch=this.match,this.match=matchPath(t.pathname,{path:this.url,exact:this.exact,strict:!0})},t.prototype.loadCompleted=function(){return __awaiter(this,void 0,void 0,function(){var t;return tslib_1.__generator(this,function(e){return t={},this.history&&this.history.location.hash?t={scrollToId:this.history.location.hash.substr(1)}:this.scrollTopOffset&&(t={scrollTopOffset:this.scrollTopOffset}),"function"==typeof this.componentUpdated?this.componentUpdated(t):this.match&&!matchesAreEqual(this.match,this.previousMatch)&&this.routeViewsUpdated&&this.routeViewsUpdated(t),[2]})})},t.prototype.componentDidUpdate=function(){return __awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(t){switch(t.label){case 0:return[4,this.loadCompleted()];case 1:return t.sent(),[2]}})})},t.prototype.componentDidLoad=function(){return __awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(t){switch(t.label){case 0:return[4,this.loadCompleted()];case 1:return t.sent(),[2]}})})},t.prototype.render=function(){if(!this.match||!this.history)return null;var t=Object.assign({},this.componentProps,{history:this.history,match:this.match});return this.routeRender?this.routeRender(Object.assign({},t,{component:this.component})):this.component?h(this.component,Object.assign({},t)):void 0},Object.defineProperty(t,"is",{get:function(){return"stencil-route"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"properties",{get:function(){return{component:{type:String,attr:"component"},componentProps:{type:"Any",attr:"component-props"},componentUpdated:{type:"Any",attr:"component-updated"},el:{elementRef:!0},exact:{type:Boolean,attr:"exact"},group:{type:String,attr:"group",reflectToAttr:!0},history:{type:"Any",attr:"history"},historyType:{type:String,attr:"history-type"},location:{type:"Any",attr:"location",watchCallbacks:["computeMatch"]},match:{type:"Any",attr:"match",mutable:!0},routeRender:{type:"Any",attr:"route-render"},routeViewsUpdated:{type:"Any",attr:"route-views-updated"},scrollTopOffset:{type:Number,attr:"scroll-top-offset"},url:{type:String,attr:"url"}}},enumerable:!0,configurable:!0}),Object.defineProperty(t,"style",{get:function(){return"/**style-placeholder:stencil-route:**/"},enumerable:!0,configurable:!0}),t}();function uuidv4(){return([1e7].toString()+-1e3.toString()+-4e3.toString()+-8e3.toString()+-1e11.toString()).replace(/[018]/g,function(t){return(t^window.crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)})}ActiveRouter.injectProps(Route,["location","history","historyType","routeViewsUpdated"]);var __awaiter$1=function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(a,s)}c((o=o.apply(t,e||[])).next())})};function getUniqueId(){return window.crypto?uuidv4():((1e17*Math.random()).toString().match(/.{4}/g)||[]).join("-")}function getMatch(t,e,n){return matchPath(t,{path:e,exact:n,strict:!0})}function isHTMLStencilRouteElement(t){return"stencil-route"===t.tagName.toLowerCase()}var RouteSwitch=function(){function t(){this.group=getUniqueId(),this.subscribers=[]}return t.prototype.componentWillLoad=function(){null!=this.location&&this.regenerateSubscribers(this.location)},t.prototype.regenerateSubscribers=function(t){return __awaiter$1(this,void 0,void 0,function(){var e,n,o=this;return tslib_1.__generator(this,function(r){return null==t?[2]:(e=-1,this.subscribers=Array.prototype.slice.call(this.el.children).filter(isHTMLStencilRouteElement).map(function(n,o){var r=getMatch(t.pathname,n.url,n.exact);return r&&-1===e&&(e=o),{el:n,match:r}}),-1===e?[2]:this.activeIndex===e?(this.subscribers[e].el.match=this.subscribers[e].match,[2]):(this.activeIndex=e,n=this.subscribers[this.activeIndex],this.scrollTopOffset&&(n.el.scrollTopOffset=this.scrollTopOffset),n.el.group=this.group,n.el.match=n.match,n.el.componentUpdated=function(t){o.queue.write(function(){o.subscribers.forEach(function(t,e){if(t.el.componentUpdated=void 0,e===o.activeIndex)return t.el.style.display="";o.scrollTopOffset&&(t.el.scrollTopOffset=o.scrollTopOffset),t.el.group=o.group,t.el.match=null,t.el.style.display="none"})}),o.routeViewsUpdated&&o.routeViewsUpdated(Object.assign({scrollTopOffset:o.scrollTopOffset},t))},[2]))})})},t.prototype.render=function(){return h("slot",null)},Object.defineProperty(t,"is",{get:function(){return"stencil-route-switch"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"properties",{get:function(){return{el:{elementRef:!0},group:{type:String,attr:"group",reflectToAttr:!0},location:{type:"Any",attr:"location",watchCallbacks:["regenerateSubscribers"]},queue:{context:"queue"},routeViewsUpdated:{type:"Any",attr:"route-views-updated"},scrollTopOffset:{type:Number,attr:"scroll-top-offset"}}},enumerable:!0,configurable:!0}),t}();function invariant(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t||console.error.apply(console,e)}function warning(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t||console.warn.apply(console,e)}ActiveRouter.injectProps(RouteSwitch,["location","routeViewsUpdated"]);var createTransitionManager=function(){var t,e=[];return{setPrompt:function(e){return warning(null==t,"A history supports only one prompt at a time"),t=e,function(){t===e&&(t=null)}},confirmTransitionTo:function(e,n,o,r){if(null!=t){var i="function"==typeof t?t(e,n):t;"string"==typeof i?"function"==typeof o?o(i,r):(warning(!1,"A history needs a getUserConfirmation function in order to use a prompt message"),r(!0)):r(!1!==i)}else r(!0)},appendListener:function(t){var n=!0,o=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];n&&t.apply(void 0,e)};return e.push(o),function(){n=!1,e=e.filter(function(t){return t!==o})}},notifyListeners:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.forEach(function(e){return e.apply(void 0,t)})}}},createScrollHistory=function(t){void 0===t&&(t="scrollPositions");var e=new Map;if(storageAvailable("sessionStorage")){var n=window.sessionStorage.getItem(t);e=n?new Map(JSON.parse(n)):e}function o(t,n){if(e.set(t,n),storageAvailable("sessionStorage")){var o=[];e.forEach(function(t,e){o.push([e,t])}),window.sessionStorage.setItem("scrollPositions",JSON.stringify(o))}}return"scrollRestoration"in history&&(history.scrollRestoration="manual"),{set:o,get:function(t){return e.get(t)},has:function(t){return e.has(t)},capture:function(t){o(t,[window.scrollX,window.scrollY])}}},PopStateEvent="popstate",HashChangeEvent="hashchange",getHistoryState=function(){try{return window.history.state||{}}catch(t){return{}}},createBrowserHistory=function(t){void 0===t&&(t={}),invariant(canUseDOM,"Browser history needs a DOM");var e=window.history,n=supportsHistory(),o=!supportsPopStateOnHashChange(),r=createScrollHistory(),i=null!=t.forceRefresh&&t.forceRefresh,a=null!=t.getUserConfirmation?t.getUserConfirmation:getConfirmation,s=null!=t.keyLength?t.keyLength:6,c=t.basename?stripTrailingSlash(addLeadingSlash(t.basename)):"",u=function(t){var e=(t=t||{}).key,n=t.state,o=window.location,r=o.pathname+o.search+o.hash;return warning(!c||hasBasename(r,c),'You are attempting to use a basename on a page whose URL path does not begin with the basename. Expected path "'+r+'" to begin with "'+c+'".'),c&&(r=stripBasename(r,c)),createLocation(r,n,e||createKey(s))},l=createTransitionManager(),h=function(t){r.capture(T.location.key),Object.assign(T,t),T.location.scrollPosition=r.get(T.location.key),T.length=e.length,l.notifyListeners(T.location,T.action)},p=function(t){isExtraneousPopstateEvent(t)||y(u(t.state))},f=function(){y(u(getHistoryState()))},d=!1,y=function(t){d?(d=!1,h()):l.confirmTransitionTo(t,"POP",a,function(e){e?h({action:"POP",location:t}):g(t)})},g=function(t){var e=m.indexOf(T.location.key);-1===e&&(e=0);var n=m.indexOf(t.key);-1===n&&(n=0);var o=e-n;o&&(d=!0,b(o))},v=u(getHistoryState()),m=[v.key],w=function(t){return c+createPath(t)},b=function(t){e.go(t)},P=0,S=function(t){1===(P+=t)?(addEventListener(window,PopStateEvent,p),o&&addEventListener(window,HashChangeEvent,f)):0===P&&(removeEventListener(window,PopStateEvent,p),o&&removeEventListener(window,HashChangeEvent,f))},O=!1,T={length:e.length,action:"POP",location:v,createHref:w,push:function(t,o){warning(!("object"==typeof t&&void 0!==t.state&&void 0!==o),"You should avoid providing a 2nd state argument to push when the 1st argument is a location-like object that already has state; it is ignored");var r=createLocation(t,o,createKey(s),T.location);l.confirmTransitionTo(r,"PUSH",a,function(t){if(t){var o=w(r),a=r.state;if(n)if(e.pushState({key:r.key,state:a},void 0,o),i)window.location.href=o;else{var s=m.indexOf(T.location.key),c=m.slice(0,-1===s?0:s+1);c.push(r.key),m=c,h({action:"PUSH",location:r})}else warning(void 0===a,"Browser history cannot push state in browsers that do not support HTML5 history"),window.location.href=o}})},replace:function(t,o){warning(!("object"==typeof t&&void 0!==t.state&&void 0!==o),"You should avoid providing a 2nd state argument to replace when the 1st argument is a location-like object that already has state; it is ignored");var r=createLocation(t,o,createKey(s),T.location);l.confirmTransitionTo(r,"REPLACE",a,function(t){if(t){var o=w(r),a=r.state;if(n)if(e.replaceState({key:r.key,state:a},void 0,o),i)window.location.replace(o);else{var s=m.indexOf(T.location.key);-1!==s&&(m[s]=r.key),h({action:"REPLACE",location:r})}else warning(void 0===a,"Browser history cannot replace state in browsers that do not support HTML5 history"),window.location.replace(o)}})},go:b,goBack:function(){return b(-1)},goForward:function(){return b(1)},block:function(t){void 0===t&&(t="");var e=l.setPrompt(t);return O||(S(1),O=!0),function(){return O&&(O=!1,S(-1)),e()}},listen:function(t){var e=l.appendListener(t);return S(1),function(){S(-1),e()}}};return T},HashChangeEvent$1="hashchange",HashPathCoders={hashbang:{encodePath:function(t){return"!"===t.charAt(0)?t:"!/"+stripLeadingSlash(t)},decodePath:function(t){return"!"===t.charAt(0)?t.substr(1):t}},noslash:{encodePath:stripLeadingSlash,decodePath:addLeadingSlash},slash:{encodePath:addLeadingSlash,decodePath:addLeadingSlash}},getHashPath=function(){var t=window.location.href,e=t.indexOf("#");return-1===e?"":t.substring(e+1)},pushHashPath=function(t){return window.location.hash=t},replaceHashPath=function(t){var e=window.location.href.indexOf("#");window.location.replace(window.location.href.slice(0,e>=0?e:0)+"#"+t)},createHashHistory=function(t){void 0===t&&(t={}),invariant(canUseDOM,"Hash history needs a DOM");var e=window.history,n=supportsGoWithoutReloadUsingHash(),o=null!=t.keyLength?t.keyLength:6,r=t.getUserConfirmation,i=void 0===r?getConfirmation:r,a=t.hashType,s=void 0===a?"slash":a,c=t.basename?stripTrailingSlash(addLeadingSlash(t.basename)):"",u=HashPathCoders[s],l=u.encodePath,h=u.decodePath,p=function(){var t=h(getHashPath());return warning(!c||hasBasename(t,c),'You are attempting to use a basename on a page whose URL path does not begin with the basename. Expected path "'+t+'" to begin with "'+c+'".'),c&&(t=stripBasename(t,c)),createLocation(t,void 0,createKey(o))},f=createTransitionManager(),d=function(t){Object.assign(x,t),x.length=e.length,f.notifyListeners(x.location,x.action)},y=!1,g=null,v=function(){var t=getHashPath(),e=l(t);if(t!==e)replaceHashPath(e);else{var n=p();if(!y&&locationsAreEqual(x.location,n))return;if(g===createPath(n))return;g=null,m(n)}},m=function(t){y?(y=!1,d()):f.confirmTransitionTo(t,"POP",i,function(e){e?d({action:"POP",location:t}):w(t)})},w=function(t){var e=O.lastIndexOf(createPath(x.location));-1===e&&(e=0);var n=O.lastIndexOf(createPath(t));-1===n&&(n=0);var o=e-n;o&&(y=!0,T(o))},b=getHashPath(),P=l(b);b!==P&&replaceHashPath(P);var S=p(),O=[createPath(S)],T=function(t){warning(n,"Hash history go(n) causes a full page reload in this browser"),e.go(t)},H=0,L=function(t){1===(H+=t)?addEventListener(window,HashChangeEvent$1,v):0===H&&removeEventListener(window,HashChangeEvent$1,v)},E=!1,x={length:e.length,action:"POP",location:S,createHref:function(t){return"#"+l(c+createPath(t))},push:function(t,e){warning(void 0===e,"Hash history cannot push state; it is ignored");var n=createLocation(t,void 0,createKey(o),x.location);f.confirmTransitionTo(n,"PUSH",i,function(t){if(t){var e=createPath(n),o=l(c+e);if(getHashPath()!==o){g=e,pushHashPath(o);var r=O.lastIndexOf(createPath(x.location)),i=O.slice(0,-1===r?0:r+1);i.push(e),O=i,d({action:"PUSH",location:n})}else warning(!1,"Hash history cannot PUSH the same path; a new entry will not be added to the history stack"),d()}})},replace:function(t,e){warning(void 0===e,"Hash history cannot replace state; it is ignored");var n=createLocation(t,void 0,createKey(o),x.location);f.confirmTransitionTo(n,"REPLACE",i,function(t){if(t){var e=createPath(n),o=l(c+e);getHashPath()!==o&&(g=e,replaceHashPath(o));var r=O.indexOf(createPath(x.location));-1!==r&&(O[r]=e),d({action:"REPLACE",location:n})}})},go:T,goBack:function(){return T(-1)},goForward:function(){return T(1)},block:function(t){void 0===t&&(t="");var e=f.setPrompt(t);return E||(L(1),E=!0),function(){return E&&(E=!1,L(-1)),e()}},listen:function(t){var e=f.appendListener(t);return L(1),function(){L(-1),e()}}};return x},__awaiter$2=function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(a,s)}c((o=o.apply(t,e||[])).next())})};function getLocation(t,e){var n=0==t.pathname.indexOf(e)?"/"+t.pathname.slice(e.length):t.pathname;return Object.assign({},t,{pathname:n})}var HISTORIES={browser:createBrowserHistory,hash:createHashHistory},Router=function(){function t(){var t=this;this.root="/",this.historyType="browser",this.titleSuffix="",this.routeViewsUpdated=function(e){if(void 0===e&&(e={}),e.scrollToId&&"browser"===t.historyType){var n=document.getElementById(e.scrollToId);if(n)return n.scrollIntoView()}t.scrollTo(e.scrollTopOffset||t.scrollTopOffset)}}return t.prototype.componentWillLoad=function(){var t=this;this.history=HISTORIES[this.historyType](),this.history.listen(function(e){return __awaiter$2(t,void 0,void 0,function(){return tslib_1.__generator(this,function(t){return e=getLocation(e,this.root),this.location=e,[2]})})}),this.location=getLocation(this.history.location,this.root)},t.prototype.scrollTo=function(t){var e=this;if(null!=t&&!this.isServer&&this.history)return"POP"===this.history.action&&Array.isArray(this.history.location.scrollPosition)?this.queue.write(function(){e.history&&e.history.location&&Array.isArray(e.history.location.scrollPosition)&&window.scrollTo(e.history.location.scrollPosition[0],e.history.location.scrollPosition[1])}):this.queue.write(function(){window.scrollTo(0,t)})},t.prototype.render=function(){if(this.location&&this.history)return h(ActiveRouter.Provider,{state:{historyType:this.historyType,location:this.location,titleSuffix:this.titleSuffix,root:this.root,history:this.history,routeViewsUpdated:this.routeViewsUpdated}},h("slot",null))},Object.defineProperty(t,"is",{get:function(){return"stencil-router"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"properties",{get:function(){return{history:{state:!0},historyType:{type:String,attr:"history-type"},isServer:{context:"isServer"},location:{state:!0},queue:{context:"queue"},root:{type:String,attr:"root"},scrollTopOffset:{type:Number,attr:"scroll-top-offset"},titleSuffix:{type:String,attr:"title-suffix"}}},enumerable:!0,configurable:!0}),t}();export{AppRoot,Route as StencilRoute,RouteSwitch as StencilRouteSwitch,Router as StencilRouter};